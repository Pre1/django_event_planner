{% extends "base.html" %}
{% load static %}
{% block content %}

<header class="masthead text-center">
  <div class="bg-circle-1 bg-circle"></div>
  <div class="bg-circle-2 bg-circle"></div>
  <div class="bg-circle-3 bg-circle"></div>
  <div class="bg-circle-4 bg-circle"></div>
<div class="container">

  <div class="alert alert-light text-center" role="alert">
    <div class="card-body my-1">
     
        <h5 class="card-title">{{user.first_name}}{{user.last_name}}</h5>
        <p class="card-text">{{user.username}}</p>
        <br>
    </div>

    {# USER PROFILE CARD #}
    <div class="card mb-3" style="max-width: 540px;">
      <div class="row no-gutters">
          <div class="col-md-4">
              <img src="{% static "img/profile_def.png" %}" class="card-img" alt="...">
          </div>
          <div class="col-md-8">
              <div class="card-body">
                  <h5 class="card-title text-left">{{user.username}}</h5>
                  <p class="card-text">{{user.first_name}}{{user.last_name}}</p>
              </div>
          </div>
            <p class="card">
              {% if request.user == user %}
                <a href="{% url 'profile-update' %}" class="btn btnr text-center">Update Profile</a>

                <button id="profile-{{user.id}}" class="btn btn-primary"  onclick="follow({{user.id}})">
                      {% if request.user.id in following %}
                        Unfollow
                      {% else %}
                        Follow
                      {% endif %}
                </button>
                Following: {{following.count}} |
                Followers: {{followers.count}}
            {%endif%}
          </p>
      </div>
      <script>
            function follow(user_id){
              var button = "#profile-" + user_id;

              $.ajax({

                type: "GET",

                url: "/follow/"+user_id+"/",

                success: function(data){
                  if(data.following){
                    $(button).text('Unfollow');
                  }
                  else {
                    $(button).text('Follow');
                  }
                },

                error: function(){
                  console.log("Stop bro!");
                },

              })
            }      
          </script>
    </div>
    {# =============== #}

    <div class="row">
      {% for event in events %} 
            <div class="col-6 text-center" >
              <div class="card">
                   <div class="img1">
                  <a href="{{event.get_absolute_url}}"><img class="card-img-top" src="{{event.poster.url}}" alt="Card image cap"/></a></div>
                  <h5 class="card-title position-absolute">{{event.title}}</h5>
                
                <div class="card-body">
                    <h5 class="card-title hi">{{event.title}}</h5>
                    <p class="card-text">Date: {{event.date}}</p>
                    <p class="card-text">time: {{event.time}}</p>
                    <a href="{{event.get_absolute_url}}" class="btn btnr">More Info</a>  
                </div>
              </div>
            </div>
      {% endfor %}
    </div>  
  </div>
</div>

</header>
{% endblock %}